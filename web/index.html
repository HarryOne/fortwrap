<html>
  <head>
    <title>FortWrap</title>
    <link rel=stylesheet href="style.css" type="text/css">
  </head>
    
<body>
  <h1>FortWrap</h1>

  <p><b>FortWrap version 0.9 released 8/18/2010</b></p>

  <p>FortWrap is a python script that parses Fortran 90/95/200X source
  files and generates wrapper code for interfacing with the original
  Fortran code from C++.  FortWrap is compatible with
  both <a href="http://www.g95.org">g95</a>
  and <a href="http://gcc.gnu.org/fortran/">gfortran</a> and is
  intended to be used with Fortran code that takes an object oriented
  approach and makes use of Fortran derived types.  The resulting
  wrapper code provides a C++ interface that wraps the Fortran derived
  types with C++ proxy classes.</p>

  <p>For example, consider the following Fortran code:</p>

  <div class="code"> <pre>
MODULE m

  TYPE Object
    ... 
  END TYPE Object

CONTAINS
    
  SUBROUTINE object_ctor(o, n, x)
    TYPE (Object) :: o
    INTEGER, INTENT(in) :: n
    REAL, INTENT(in) :: x(n)
    ...
  END SUBROUTINE object_ctor

  SUBROUTINE process(o)
    TYPE (Object) :: o
    ...
  END SUBROUTINE process
  
END MODULE m
  </pre></div>      

  <p>After wrapping with FortWrap, these routines can be utilized in a
  natural way from C++:</p>

  <div class="targetlang"> <pre>
std::vector&lt;float&gt; x(10);
... // Define values for x
Object o(&x); // C++ constructor: automatically calls object_ctor
o.process();
  </pre></div>

  <p>Additional examples can be found <a href="examples.html">here</a>

  <h2>Wrapping for other languages</h2>

 <p>FortWrap can also be used as an intermediary step for wrapping
   Fortran code with <a href="http://www.swig.org">Swig</a>.  The C++
   header files generated by FortWrap can be directly processed by
   Swig using the <tt>-c++</tt> option. This allows you to take full
   advantage of Swig's powerful capabilities for wrapping C++ code.
   For example, FortWrap can be used with Swig to create an object
   oriented interface in python.  This works particularly well with
   Swig's <tt>-keyword</tt> argument for handling Fortran optional
   arguments.


  <h2>Obtaining FortWrap</h2>

  FortWrap may be downloaded
  from <a href="https://sourceforge.net/projects/fortwrap/">https://sourceforge.net/projects/fortwrap/</a>.

<h2>Main Features</h2>

<ul>
  <li> <b>Derived Types</b>: Transparent translation of Fortran derived types into C++ classes.  This is the main objective of FortWrap.</li>
  <ul>
    <li> Translation of Fortran "ctor" functions into C++ constructors</li>
    <li> Fortran "dtor" functions automatically called by C++ destructor</li>
  </ul>

  <li> <b>Optional arguments</b>: Fortran optional arguments are fully
    supported, with automatic NULL default values in C++.</li>

  <li> <b>Procedure pointers</b>: C++ function pointers may be passed
    natively where Fortran expects a procedure pointer.  Right now this
    requires that the Fortran procedure pointer have an
    explicit <tt>ABSTRACT INTERFACE</tt></li>
  
  <li> <b>Arrays</b>: One-dimensional arrays are translated into C++
    vector containers.  Subroutine arguments used to define the Fortran
    array size are automatically calculated based on the C++ vector.</li>
  
  <li> <b>Matrices</b>: A "FortranMatrix" C++ class is provided for
    interfacing with two-dimensional Fortran arrays (matrices).  This
    class takes care to store data internally in Fortran order.</li>

  <li> Name mangling support for both gfortran and g95 compilers
    
  <li> Character arrays with <tt>INTENT(OUT)</tt> and explicit length
    parameter are translated into C++ strings.</li>

  <li> Where possible, pass by value is used in C++ (e.g. scalar
    arguments that are not optional)</li>

  <li> <b>Doxygen comments</b>: Doxygen-style comments used for
    Fortran symbols (derived types, subroutines, arguments) are
    transferred to C++ doxygen comments in the wrapper code.</li>

  <li> Automatic handling of Fortran <tt>PUBLIC</tt>
    and <tt>PRIVATE</tt> statements.  By default, only <tt>PUBLIC</tt>
    routines are wrapped.</li>
</ul>

<h2>Unsupported Features</h2>

<p>Many features of Fortran 90/95/2003 are not supported by FortWrap.
In some cases (e.g. assumed shape arrays) this is because the Fortran
language standard does not provide an interoperability mechanism.</p>

<p>Note that in most cases FortWrap will quietly leave out wrapper code
for subroutines that contain unsupported argument types that are not
optional.  In most situations, it is possible to get FortWrap to wrap
these types of routines by providing a Fortran wrapper that is
  interoperable and calls the target routine.</p>

<p>The following argument types/constructs/features are not
supported:</p>

<ul>
  <li> Assumed shape arrays (a declaration that looks like <tt>INTEGER
      :: X(:)</tt>).  The Fortran standard does not provide an
      interoperability mechanism for assumed shape arrays.</li>

  <li> Assumed size arrays (<tt>INTEGER :: X(*)</tt>).  These could be
    supported but are less useful than providing an explicit size
    because the Fortran routine will not know the size of the
    array.</li>

  <li> Character arrays with intent other than <tt>INTENT(OUT)</tt></li>

  <li> Arrays of dimensionality greater than 2 are not supported.</li>

  <li> <tt>KIND</tt>: only limited support is provided for specifying
    the <tt>KIND</tt> of primitive types.  For <tt>REAL</tt>
    arguments, <tt>KIND</tt>s of 4 and 8 are supported,
    otherwise <tt>KIND</tt> is not supported.</li>

  <li> Arrays of a derived type.  These can be wrapped by creating a
    new derived type to contain an array of the derived type of
    interest.</li>

  <li> Fortran functions with non-primitive return types are not
    wrapped.</li>

  <li> Wrapping Fortran code outside of a <tt>MODULE</tt> is not
    currently supported.  Note that the main purpose of FortWrap is to
    wrap derived types, which requires the use of <tt>MODULE</tt></li>

  <li> <b>CLASS</b> (polymorphic) variables.  This Fortran language
    features is not supported by g95 and is currently making its way
    online with gfortran.  Unfortunately, the Fortran 2003 standard
    does not allow C_LOC to be used on <tt>CLASS</tt> pointers, so
    there is not a standard-compliant way of working with these
    variables.  However, experimental support for FortWrap to generate
    polymorphic C++ wrappers around Fortran <tt>CLASS</tt> constructs
    is already underway, although it relies on gfortran-specific
    compiler implementation details.</li>
</ul>


</body>

</html>
