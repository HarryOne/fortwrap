<html>
  <head>
    <title>FortWrap</title>
    <link rel=stylesheet href="style.css" type="text/css">
  </head>
    
<body>
  <h1>FortWrap</h1>

  <p><b>FortWrap version 0.9 released 8/18/2010</b></p>

  <ul>
    <li><a href="#Introduction">Introduction</a></li>
    <li><a href="#Swig">Wrapping for other languages</a></li>
    <li><a href="#Obtaining">Obtaining FortWrap</a></li>
    <li><a href="#Features">Main Features</a></li>
    <li><a href="#Unsupported">Unsupported Features</a></li>
    <li><a href="#Issues">Known Issues</a></li>
  </ul>

  <h2><a name="Introduction">Introduction</a></h2>

  <p>FortWrap is a python script that parses Fortran 90/95/200X source
  files and generates wrapper code for interfacing with the original
  Fortran code from C++.  FortWrap is compatible with
  both <a href="http://www.g95.org">g95</a>
  and <a href="http://gcc.gnu.org/fortran/">gfortran</a> and is
  intended to be used with Fortran code that takes an object oriented
  approach and makes use of Fortran derived types.  The resulting
  wrapper code provides a C++ interface that wraps the Fortran derived
  types with C++ proxy classes.</p>

  <p>For example, consider the following Fortran code:</p>

  <div class="code"> <pre>
MODULE m

  TYPE Object
    ... 
  END TYPE Object

CONTAINS
    
  SUBROUTINE object_ctor(o, n, x)
    TYPE (Object) :: o
    INTEGER, INTENT(in) :: n
    REAL, INTENT(in) :: x(n)
    ...
  END SUBROUTINE object_ctor

  SUBROUTINE foo(o)
    TYPE (Object) :: o
    ...
  END SUBROUTINE foo
  
END MODULE m
  </pre></div>      

  <p>After wrapping with FortWrap, these routines can be utilized in a
  natural way from C++:</p>

  <div class="targetlang"> <pre>
std::vector&lt;float&gt; x(10);
... // Define values for x
Object o(&x); // C++ constructor: automatically calls object_ctor
o.foo();
  </pre></div>

  <p>Additional examples can be found <a href="examples.html">here</a>

    <h2><a name="Swig">Wrapping for other languages</a></h2>

 <p>FortWrap can also be used as an intermediary step for wrapping
   Fortran code with <a href="http://www.swig.org">Swig</a>.  The C++
   header files generated by FortWrap can be directly processed by
   Swig using the <tt>-c++</tt> option. This allows you to take full
   advantage of Swig's powerful capabilities for wrapping C++ code.
   For example, FortWrap can be used with Swig to create an object
   oriented interface in python.  This works particularly well with
   Swig's <tt>-keyword</tt> argument for handling Fortran optional
   arguments.


   <h2><a name="Obtaining">Obtaining FortWrap</a></h2>

  FortWrap may be downloaded
  from <a href="https://sourceforge.net/projects/fortwrap/">https://sourceforge.net/projects/fortwrap/</a>.

   <h2><a name="Features">Main Features</a></h2>

<ul>
  <li> <b>Derived Types</b>: Transparent translation of Fortran derived types into C++ classes.  This is the main objective of FortWrap.</li>
  <ul>
    <li> Translation of Fortran "ctor" functions into C++ constructors</li>
    <li> Fortran "dtor" functions automatically called by C++ destructor</li>
  </ul>

  <li> <b>Optional arguments</b>: Fortran optional arguments are fully
    supported, with automatic NULL default values in C++.</li>

  <li> <b>Procedure pointers</b>: C++ function pointers may be passed
    natively where Fortran expects a procedure pointer.  Right now this
    requires that the Fortran procedure pointer have an
    explicit <tt>ABSTRACT INTERFACE</tt></li>
  
  <li> <b>Arrays</b>: By default, one-dimensional arrays are
    translated into C++ vector containers.  Subroutine arguments used
    to define the Fortran array size are automatically calculated
    based on the C++ vector.</li>
  
  <li> <b>Matrices</b>: A "FortranMatrix" C++ class is provided for
    interfacing with two-dimensional Fortran arrays (matrices).  This
    class takes care to store data internally in Fortran order.</li>

  <li> <b>Strings</b> with <tt>INTENT(IN)</tt> or <tt>INTENT(OUT)</tt>
    and explicit length parameter are wrapped using C++ strings or
    character arrays.</li>

  <li>"Top-level" (a.k.a. global or non-module) procedures are wrapped</li>

  <li> Name mangling support for both gfortran and g95 compilers
    
  <li> Where possible, pass by value is used in C++ (e.g. scalar
    arguments that are not optional)</li>

  <li> <b>Doxygen comments</b>: Doxygen-style comments used for
    Fortran symbols (derived types, subroutines, arguments) are
    transferred to C++ doxygen comments in the wrapper code.</li>

  <li> Automatic handling of Fortran <tt>PUBLIC</tt>
    and <tt>PRIVATE</tt> statements.  By default, only <tt>PUBLIC</tt>
    routines are wrapped.</li>

  <li>Generates clean, human-readable wrapper code</li>
</ul>

<h2><a name="Unsupported">Unsupported Features</a></h2>

<p>Many features of Fortran 90/95/2003 are not supported by FortWrap.
In some cases (e.g. assumed shape arrays) this is because the Fortran
language standard does not provide an interoperability mechanism.</p>

<p>In most situations, it is possible to get FortWrap to wrap these
types of routines by providing a Fortran wrapper that is interoperable
and calls the target routine.</p>

<p>The following argument types/constructs/features are not
supported:</p>

<ul>
  <li><tt>ALLOCATABLE</tt> or <tt>POINTER</tt> arguments</li>

  <li> Assumed shape arrays (a declaration that looks like <tt>INTEGER
      :: X(:)</tt>).  The Fortran standard does not provide an
      interoperability mechanism for assumed shape arrays.</li>

  <li> Strings with <tt>INTENT(INOUT)</tt>.  Arrays of strings</li>

  <li> Arrays of a derived type.  These can be wrapped by creating a
    new derived type to contain an array of the derived type of
    interest.  Create an "append" function in Fortran that accepts
    only scalars but allows you to add items to the array container
    one at a time.</li>

  <li> Fortran functions with non-primitive return types are not
    wrapped.</li>

  <li><tt>COMPLEX</tt> data type is not supported</li>

  <li> <b>CLASS</b> (polymorphic) variables.  This Fortran language
    features is not supported by g95 and is currently making its way
    online with gfortran.  Unfortunately, the Fortran 2003 standard
    does not allow C_LOC to be used on <tt>CLASS</tt> pointers, so
    there is not a standard-compliant way of working with these
    variables.  However, experimental support for FortWrap to generate
    polymorphic C++ wrappers around Fortran <tt>CLASS</tt> constructs
    is already underway, although it relies on gfortran-specific
    compiler implementation details.</li>

  <li>Type bound procedures.  Those that were not declared
    as <tt>NOPASS</tt> require that the firrst argument be declared
    using <tt>CLASS</tt> instead of <tt>TYPE</tt>.  FortWrap does not
    currently handle <tt>CLASS</tt>: see above.</li>
</ul>

  <p>Note that FortWrap can still wrap procedures that use unsupported
    arguments if those arguments are optional.  In these cases, the
    offending arguments are hidden from the generated interface
    code.</p>

  <h2><a name="Issues">Known Issues</a></h2>

  <ul>
  </ul>

</body>

</html>
